<!--
index.html:

This HTML document sets up the most basic of UIs for the F prime webified GUI layer. This GUI layer is built with the
Bootstrap CSS, but without the paired JavaScript packages.


This GUI provides the following items:

1. Events panel showing events in the system
2. Channels panel showing latest channel readings
3. Commands panel allowing for commanding of the system

Note: Bootstrap is used, as it can be run as a CSS framework without many node and JavaScript packages.
Note: Vue.js annotations are used, as Vue is the data-to-view framework of choice.  It can be run with a single JS
      dependency, without need for WebPack or other module loaders.
-->
<!doctype html>
<html>
    <head>
        <link rel="stylesheet" href="css/third-party/bootstrap.min.css"
              integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T">
        <link rel="stylesheet" href="css/third-party/vue-select.css">
        <!-- Development mode -Vue- should it be needed for debug purposes -->
        <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

        <!-- Third-party JavaScript files, hosted locally to remove internet dependence -->
        <!--script src="js/third-party/vue.min.js"></script-->
        <script src="js/third-party/sorttable.js"></script>
        <!-- JavaScript GDS files -->
        <script type="module" src="js/gds.js"></script>
    </head>
    <body>
        <div id="tabetc" class="container">
            <tabbed-etc
                    v-bind:commands="commands"
                    v-bind:loader="loader"
                    v-bind:events="events"
                    v-bind:channels="channels"
                    v-bind:cmdhist="cmdhist"
            ></tabbed-etc>
        </div>

        <div hidden>
            <!-- Tabbed and routed Command Component -->
            <template id="tabetc-template">
                <div>
                    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                        <span class="navbar-brand">F´</span>
                            <div class="navbar-nav">
                                <div v-for="tab in tabs"
                                    v-bind:class="['nav-item', 'nav-link', { active: currentTab == tab }]"
                                    v-bind:key="tab"
                                    v-on:click="currentTab = tab">{{ tab }}</div>
                            </div>
                    </nav>
                    <h1>F´ Ground Control Interface: {{ currentTab }}</h1>
                    <!-- NOTE: *must* use v-show, as v-if will perish the component losing state -->
                    <command-input v-bind:commands="commands" v-bind:loader="loader" v-bind:cmdhist="cmdhist"
                       v-show="currentTab == 'Commanding'"></command-input>
                    <channel-table v-bind:channels="channels" v-show="currentTab == 'Channels'"></channel-table>
                    <event-list v-bind:events="events" v-show="currentTab == 'Events'"></event-list>
                </div>
            </template>


            <!--
            Command Templates:

            Some such thing.
            -->
            <template id="command-input-template">
                <div>
                    <h2>Command Sending: {{ selected.mnemonic }}</h2>
                    <div class="form-row">
                        <div class="form-group col">
                            <label for="mnemonic">Mnemonic</label>
                            <v-select id="mnemonic" style="flex: 1 1 auto;" :clearable="false" :searchable="true"
                                      :filterable="true"  label="mnemonic" :options="commandList" v-model="selected">
                            </v-select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col" v-for="argument in selected.args">
                            <label :for="argument.name">{{ argument.name }}</label>
                            <input type="text" :id="argument.name" class="form-control"
                                 :placeholder="argument.name"
                                 v-model="argument.value">
                        </div>
                    </div>
                    <div class="form-row">
                        <button type="button" class="col btn btn-danger" v-on:click="clearArguments">Clear Arguments</button>
                        <button type="button" :disabled="active" class="col btn btn-success" v-on:click="sendCommand">
                            Send Command
                        </button>
                    </div>
                    <!--div class="form-row">
                        <label for="rawcmd">Raw Command</label>
                        <input id=rawcmd" type="text" class="form-control" v-model="raw">
                    </div-->
                    <div>
                        <h2>Command History</h2>
                        Filter <input type="input" v-model="matching"></input>
                        <div class="list-group">
                            <command-item v-for="histCommand in calculateFilteredCommandHistory"
                                        v-bind:command="histCommand"></command-item>
                        </div>
                    </div>
                </div>
            </template>
            <template id="command-item-template">
                <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                    <div class="d-flex w-100 justify-content-between">
                        <h5 class="mb-1">{{calculateCommandTime + " " + command.template.mnemonic }}</h5>
                        <small>Command Id 0x{{ command.id.toString(16) }}</small>
                    </div>
                    <p class="mb-1">Arguments: {{ command.args }}</p>
                </a>
            </template>
            <!--
            Event Templates:

            These templates provide for event listing items.
            -->
            <template id="event-list-template">
                <div>
                    Filter <input type="input" v-model="matching"></input>
                    <div class="list-group">
                        <event-item v-for="event in calculateFilteredEvents"
                                    v-bind:event="event"></event-item>
                    </div>
                </div>
            </template>
            <template id="event-item-template">
                <a href="#"
                   v-bind:class="calculateItemStyle">
                    <div class="d-flex w-100 justify-content-between">
                        <h5 class="mb-1">{{ event.template.name }}</h5>
                        <small>Event Id 0x{{ event.id.toString(16) }}</small>
                    </div>
                    <p class="mb-1">{{ event.str }}</p>
                </a>
            </template>
            <!--
            Channel Templates:

            These templates display a channel table.  It takes all channels supplied in a list, and prints a row for
            each channel. If this list contains duplicates, then the display will contain duplicates. This can be fixed
            -->
            <template id="channel-table-template">
                <div>
                <table  class="sortable table table-hover">
                    <thead>
                    <tr>
                        <th>Channel ID</th><th>Channel Name</th><th>Channel Value</th><th>Last Update Time</th>
                        <th class="sorttable_nosort">Filter <input type="input" v-model="matching"></input></th>
                    </tr>
                    </thead>
                    <tbody>
                        <tr is="channel-row"
                            v-for="chan in calculateFilteredChannels"
                            v-bind:key="chan.id"
                            v-bind:channel="chan">
                        </tr>
                    </tbody>
                </table>
                </div>
            </template>
            <template id="channel-row-template">
                <tr v-bind:class="calculateRowStyle">
                    <td>0x{{ channel.id.toString(16) }}</td>
                    <td>{{ channel.template.name }}</td>
                    <td>{{ channel.val }}</td>
                    <td colspan="2">{{ calculateChannelTime }}</td>
                </tr>
            </template>
        </div>
    </body>
</html>
